<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>data - sign-in-out</title>
    <link rel="stylesheet" href="https://unpkg.com/picnic">
    <link rel="icon" type="image/png" sizes="32x32" href="favicon-data.png">
</head>
<body>
<p>
    <button id="login">Log In</button>
    <button id="logout" style="display:none;">Log Out</button>
    <span id="user-info"></span>

    <br />
    <a href="./names.html">add / edit name</a><br />
    <a href="./list-names.html">list all names</a><br />
    <a href="./logs.html">list all logs</a><br />
</p> 
  <script src="https://cdn.auth0.com/js/auth0-spa-js/1.22/auth0-spa-js.production.js"></script>
  <script>
  (async () => {
    const auth0 = await createAuth0Client({
      domain: "dev-zpl25b7w2wfbe4ne.us.auth0.com",
      client_id: "xdXzECUgLFQTgy764bQJNc8dlYP5LZms",
      redirect_uri: "https://sign-in-out.com/data/index.html",
      audience: "YOUR_API_IDENTIFIER",
      cacheLocation: "localstorage"
    });

    const isAuthenticated = await auth0.isAuthenticated();

    if (isAuthenticated) {
      const user = await auth0.getUser();
      document.getElementById("user-info").textContent = `Welcome, ${user.name}`;
      document.getElementById("login").style.display = "none";
      document.getElementById("logout").style.display = "inline";
    } else {
      document.getElementById("login").style.display = "inline";
    }

    document.getElementById("login").onclick = () => auth0.loginWithRedirect({ redirect_uri: window.location.href });
    document.getElementById("logout").onclick = () => auth0.logout({ returnTo: window.location.href });

    // Handle redirect callback
    if (window.location.search.includes("code=")) {
      await auth0.handleRedirectCallback();
      window.location.replace(window.location.pathname);
    }
  })();
  </script>

</body>
</html>